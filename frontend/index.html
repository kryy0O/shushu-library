<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shushu Library</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>
    
    <link rel="stylesheet" href="style.css">

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        .profile-dropdown-container { position: relative; display: inline-block; }
        .profile-menu-content { display: none; position: absolute; right: 0; top: 55px; background: #2b2b2b; min-width: 200px; border-radius: 10px; border: 1px solid #444; z-index: 1000; }
        .profile-menu-content a { color: white; padding: 12px; display: block; text-decoration: none; border-bottom: 1px solid #333; }
        .profile-menu-content a:hover { background: #444; color: #ffd369; }
        .profile-menu-content.show { display: block; }
    </style>
</head>
<body>

<header>
    <div class="logo"><i class="fa-solid fa-book"></i> <span>Shushu</span></div>
    <nav class="menu">
        <ul>
            <li><a href="#book-carousel">Best Reading</a></li>
            <li><a href="#borrow-section">Borrow</a></li>
            <li><a href="#community-section">Community</a></li>
            <li><a href="#shushu-footer">About</a></li>
        </ul>
    </nav>
    <div class="auth-buttons">
        <div id="guest-nav">
            <button class="login" onclick="window.location.href='login.html'">Login</button>
            <button class="signup" onclick="window.location.href='register.html'">Sign Up</button>
        </div>
        <div id="user-nav" style="display: none; align-items: center; gap: 15px;">
            <span id="welcome-msg" style="color: white; font-weight: bold;"></span>
            <div class="profile-dropdown-container">
                <img id="user-avatar" src="" alt="Profile" style="width: 40px; height: 40px; border-radius: 50%; cursor: pointer; border: 2px solid #fff;">
                <div id="profile-menu" class="profile-menu-content">
    <a href="profile.html?tab=reading"><i class="fa-solid fa-book-open"></i> Reading Now</a>
    <a href="profile.html?tab=wishlist"><i class="fa-solid fa-heart"></i> Wishlist</a>
    <a href="profile.html?tab=borrowed"><i class="fa-solid fa-clock"></i> Borrowed</a>
    
    <a href="admin.html" style="color: #f2b705; font-weight: bold;">
        <i class="fa-solid fa-user-shield"></i> Admin Panel
    </a>

    <hr style="border: 0; border-top: 1px solid #444; margin: 5px 0;">
    
    <a href="#" 
       onclick="event.preventDefault(); localStorage.removeItem('user'); fetch('http://localhost:5000/api/auth/logout', {method: 'POST', credentials: 'include'}).finally(() => window.location.reload());" 
       style="color: #ff6b6b;">
       <i class="fa-solid fa-right-from-bracket"></i> Log Out
    </a>
</div>
            </div>
        </div>
    </div>
</header>

<button id="repair-btn" onclick="repairDatabase()">üõ†Ô∏è CLICK TO FIX MISSING BOOKS</button>

<section id="hero" class="hero">
    <img src="shushu.png" alt="Shushu" class="hero-image">
    <button class="explore-btn" onclick="document.querySelector('#borrow-section').scrollIntoView({behavior:'smooth'})">Explore More</button>
</section>

<section id="book-carousel" class="book-carousel">
  <div class="book-track">
    <div class="book-rowing">
      <img src="picture/img1.png" onerror="this.style.display='none'"><img src="picture/img2.png" onerror="this.style.display='none'"><img src="picture/img3.png" onerror="this.style.display='none'"><img src="picture/img4.png" onerror="this.style.display='none'">
    </div>
  </div>
</section>

<section id="borrow-section" class="borrow-section">
    <h2 class="section-title" style="margin-top:50px; text-align:center;">Borrow Books</h2>

    <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Search books...">
        <div class="dropdown">
            <button class="dropbtn">Categories</button>
            <div class="dropdown-content">
                <a href="#" data-category="Horror">Horror</a>
                <a href="#" data-category="Fantasy">Fantasy</a>
                <a href="#" data-category="Mystery">Mystery</a>
            </div>
        </div>
    </div>

    <div class="categories-container">
        <div class="category">
            <h3>Horror</h3>
            <div class="book-row-wrapper">
                <i class="fa-solid fa-angles-left scroll-icon left-icon"></i>
                <div class="book-row" id="horrorRow"></div> <i class="fa-solid fa-angles-right scroll-icon right-icon"></i>
            </div>
        </div>
        <div class="category">
            <h3>Fantasy</h3>
            <div class="book-row-wrapper">
                <i class="fa-solid fa-angles-left scroll-icon left-icon"></i>
                <div class="book-row" id="fantasyRow"></div> <i class="fa-solid fa-angles-right scroll-icon right-icon"></i>
            </div>
        </div>
        <div class="category">
            <h3>Mystery</h3>
            <div class="book-row-wrapper">
                <i class="fa-solid fa-angles-left scroll-icon left-icon"></i>
                <div class="book-row" id="mysteryRow"></div> <i class="fa-solid fa-angles-right scroll-icon right-icon"></i>
            </div>
        </div>
    </div>
</section>

<div id="bookModal" class="book-modal">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <div class="modal-left"><img id="modal-cover" src="" alt="Book Cover"></div>
        <div class="modal-right">
            <h2 id="modal-title">Title</h2>
            <p id="modal-author"></p>
            <p id="modal-rating"></p>
            <p id="modal-synopsis"></p>
            <button id="modal-borrow" class="borrow-btn">Borrow Now</button>
        </div>
    </div>
</div>

<section id="community-section" class="community-section">
    <h2>Shushu Community</h2>
    <div class="community-wrapper">
        <div class="comments-container"><div id="commentContainer"></div></div>
        <div class="comment-form">
            <input type="text" id="username" placeholder="Your name...">
            <textarea id="commentText" placeholder="Write a comment..."></textarea>
            <div class="form-bottom">
                <input type="file" id="commentImage">
                <button id="postBtn">Post</button>
            </div>
        </div>
    </div>
</section>

<div id="pdfReaderModal" class="reader-modal" style="display: none;">
    <div class="reader-content">
        <span class="close-reader" onclick="closeReader()">&times; Close Reader</span>
        <iframe id="pdfFrame" src="" width="100%" height="100%"></iframe>
    </div>
</div>

<style>
    /* Full Screen Reader Styles */
    .reader-modal {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.9); z-index: 5000;
        display: flex; justify-content: center; align-items: center;
    }
    .reader-content {
        width: 90%; height: 90%; background: #1a1a2e; border-radius: 10px;
        position: relative; border: 2px solid #f2b705; overflow: hidden;
    }
    .close-reader {
        position: absolute; top: 10px; right: 20px;
        color: white; font-weight: bold; cursor: pointer;
        background: #ff4757; padding: 5px 15px; border-radius: 5px; z-index: 10;
    }
    iframe { border: none; }
</style>

<footer id="shushu-footer" class="shushu-footer">
    <p style="text-align:center;">¬©2025 Shushu Library.</p>
</footer>

<script src="main.js"></script>
</body>
</html>